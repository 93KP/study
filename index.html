<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HIDDEN TRUTH - Ebook Access</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root{
  --accent1:#0ea5a4;
  --accent2:#0369a1;
  --glass: rgba(255,255,255,0.85);
}
body{
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#071b2f,#063b4a);
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
  padding:20px;
}
.card{
  background: var(--glass);
  border-radius:16px;
  padding:30px;
  max-width:400px;
  width:100%;
  box-shadow:0 12px 40px rgba(0,0,0,0.4);
  text-align:center;
  color:#072a2a;
}
.card h1{margin:0 0 10px; font-size:28px; color:#0369a1;}
.card p{margin:5px 0 20px;}
input[type=password]{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:16px;
  margin-bottom:16px;
}
button{
  padding:12px;
  border:none;
  border-radius:10px;
  background: linear-gradient(90deg,var(--accent1),var(--accent2));
  color:white;
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
}
button:active{transform:translateY(1px);}
#status{margin-top:12px; font-size:14px; color:#0369a1;}
footer{position:absolute;bottom:10px; font-size:12px; opacity:0.7;}
@media(max-width:500px){.card{padding:20px;}}
</style>
</head>
<body>

<div class="card">
  <h1>HIDDEN TRUTH</h1>
  <p>Enter password to unlock the ebook</p>
  <input type="password" id="password" placeholder="Enter your password">
  <button id="unlockBtn">Unlock Ebook</button>
  <p id="status"></p>
</div>

<footer>Â© 2026 Kushagra</footer>

<script>
const SUPABASE_URL = "https://myaaijkmljjtdfoouwgt.supabase.co";
const SUPABASE_KEY = "sb_publishable_vdD93tHbk2vuDtGPsFEHMw_2iBQgXu3";
const PDF_URL = "https://myaaijkmljjtdfoouwgt.supabase.co/storage/v1/object/public/ebooks/ht.pdf";

const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

document.getElementById("unlockBtn").addEventListener("click", async ()=>{
  const pw = document.getElementById("password").value.trim();
  const statusEl = document.getElementById("status");

  if(!pw){ statusEl.textContent="Enter a password"; return; }
  statusEl.textContent="Verifying password...";

  try{
    const { data, error } = await supabase
      .from("users")
      .select("*")
      .eq("password", pw)
      .eq("status", "active")
      .single();

    if(error){
      statusEl.textContent="Invalid password or error";
      return;
    }

    if(data){
      statusEl.textContent="Password correct! Redirecting...";
      // Redirect after 1 second
      setTimeout(()=>{ window.location.href = PDF_URL; }, 800);
    } else {
      statusEl.textContent="Invalid password";
    }

  }catch(err){
    console.error(err);
    statusEl.textContent="Unexpected error";
  }
});
</script>

</body>
</html>
